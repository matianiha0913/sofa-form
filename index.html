<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>سیستم مدیریت سفارش مبل و صندلی</title>
<style>
@font-face {
  font-family: 'IranSans';
  src: local('IranSans'), url('fonts/IRANSans.ttf') format('truetype');
}

body {
  font-family: 'IranSans', Tahoma, sans-serif;
  background-color: #ffffff;
  color: #000000;
  margin: 0;
  padding: 0;
}

h1, h2 {
  text-align: center;
  color: #00ff99;
}

.container {
  max-width: 950px;
  margin: 20px auto;
  background: #fff;
  border-radius: 10px;
  border: 2px solid #00ff99;
  box-shadow: 0 0 10px #00ff99;
  padding: 20px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}

table, th, td {
  border: 1px solid #00cc88;
}

th, td {
  padding: 8px;
  text-align: right;
}

label {
  display: block;
  margin-top: 10px;
  font-weight: bold;
}

input, textarea {
  width: 96%;
  padding: 6px;
  border-radius: 5px;
  border: 1px solid #00cc88;
  font-family: inherit;
  margin-top: 4px;
  color: #000;
}

textarea {
  min-height: 60px;
}

.btn {
  background: #00ff99;
  color: black;
  padding: 10px 14px;
  margin: 5px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-weight: bold;
}

.btn:hover {
  background: #00cc77;
}

.section {
  border: 2px solid #00cc88;
  border-radius: 8px;
  margin-top: 15px;
  padding: 10px;
  background: #f8fff8;
}

.output {
  border: 2px solid #00cc99;
  border-radius: 8px;
  margin-top: 15px;
  padding: 10px;
  background: #ffffff;
  color: #000000;
  display: none;
}

.output table {
  width: 100%;
  border-collapse: collapse;
}

.output table, .output th, .output td {
  border: 1px solid #00cc77;
}
.output th, .output td {
  padding: 6px;
}

.hidden {
  display: none;
}

@media (max-width:600px){
  .container {padding:10px}
  input,textarea {width:100%}
}
</style>
</head>
<body>

<div class="container">
  <h1>🛋 سیستم مدیریت سفارش مبل و صندلی</h1>

  <div id="form">
    <table>
      <tr>
        <td><label>نام مشتری</label><input id="customer"></td>
        <td><label>مدل</label><input id="model"></td>
        <td><label>تاریخ تحویل</label><input type="date" id="delDate"></td>
        <td><label>قیمت</label><input id="price" type="number"></td>
      </tr>
    </table>

    <div class="section">
      <h3>۱. رنگ‌کاری</h3>
      <input placeholder="رنگ کار" id="paintColor">
      <input placeholder="نوع پوشش یا لاک" id="paintFinish">
      <input placeholder="تعداد قطعات" id="paintCount">
      <textarea placeholder="توضیحات رنگ‌کاری" id="paintNote"></textarea>
    </div>

    <div class="section">
      <h3>۲. خیاطی</h3>
      <input placeholder="کد پارچه" id="fabCode">
      <input placeholder="رنگ پارچه" id="fabColor">
      <textarea placeholder="شرح تفصیلی پارچه، کوسن و موارد دیگر..." id="fabNote"></textarea>
    </div>

    <div class="section">
      <h3>۳. نجاری</h3>
      <input placeholder="مدل مبل" id="carpModel">
      <textarea placeholder="توضیحات کار نجاری (مثلاً نوع اتصال، پایه، ساختار...)" id="carpNote"></textarea>
    </div>

    <div class="section">
      <h3>۴. روی‌کوبی</h3>
      <textarea placeholder="توضیحات روی‌کوبی (نوع فوم، ابر، پارچه روبان...)" id="upNote"></textarea>
    </div>

    <div class="section">
      <h3>۵. تحویل</h3>
      <textarea placeholder="آدرس و توضیحات تحویل" id="delNote"></textarea>
    </div>

    <button class="btn" onclick="saveOrder()">💾 ذخیره سفارش</button>
    <button class="btn" onclick="toggleOrders()">📋 نمایش سفارش‌ها</button>
  </div>

  <div id="orderList" class="section hidden"></div>
  <div id="output" class="output"></div>
</div>

<script>
let orders = JSON.parse(localStorage.getItem("orders") || "[]");

function saveOrder() {
  const order = {
    customer: val('customer'),
    model: val('model'),
    price: val('price'),
    delDate: val('delDate'),
    paintColor: val('paintColor'),
    paintFinish: val('paintFinish'),
    paintCount: val('paintCount'),
    paintNote: val('paintNote'),
    fabCode: val('fabCode'),
    fabColor: val('fabColor'),
    fabNote: val('fabNote'),
    carpModel: val('carpModel'),
    carpNote: val('carpNote'),
    upNote: val('upNote'),
    delNote: val('delNote')
  };
  orders.push(order);
  localStorage.setItem("orders", JSON.stringify(orders));
  clearForm();
  alert("✅ سفارش ذخیره شد");
}

function val(id){return document.getElementById(id).value.trim();}

function clearForm(){
  document.querySelectorAll('input, textarea').forEach(el => el.value = '');
}

function toggleOrders(){
  const listDiv = document.getElementById('orderList');
  listDiv.classList.toggle('hidden');
  renderOrders();
}

function renderOrders(){
  const listDiv = document.getElementById('orderList');
  if (orders.length === 0) {
    listDiv.innerHTML = "<p>هیچ سفارشی ثبت نشده است.</p>";
    return;
  }
  listDiv.innerHTML = orders.map((o,i)=>`
  <div style="border:1px solid #00ff99;padding:8px;margin-bottom:8px;">
    <b>${o.customer}</b> | مدل: ${o.model} | تاریخ تحویل: ${o.delDate} | قیمت: ${o.price} تومان<br>
    <div style="margin-top:6px;">
      <button class="btn" onclick="showSection(${i},'paint')">🎨 رنگ‌کاری</button>
      <button class="btn" onclick="showSection(${i},'fab')">🧵 خیاطی</button>
      <button class="btn" onclick="showSection(${i},'carp')">🪓 نجاری</button>
      <button class="btn" onclick="showSection(${i},'up')">🛠 روی‌کوبی</button>
      <button class="btn" onclick="showSection(${i},'del')">🚚 تحویل</button>
    </div>
  </div>`).join('');
}

function showSection(i,type){
  const o = orders[i];
  let html="";
  if(type==='paint') html=`
  <h3>برگه رنگ‌کاری</h3>
  <table>
  <tr><th>رنگ</th><td>${o.paintColor}</td></tr>
  <tr><th>پوشش</th><td>${o.paintFinish}</td></tr>
  <tr><th>تعداد قطعات</th><td>${o.paintCount}</td></tr>
  <tr><th>توضیحات</th><td>${o.paintNote}</td></tr>
  </table>`;

  if(type==='fab') html=`
  <h3>برگه خیاطی</h3>
  <table>
  <tr><th>کد پارچه</th><td>${o.fabCode}</td></tr>
  <tr><th>رنگ پارچه</th><td>${o.fabColor}</td></tr>
  <tr><th>توضیحات</th><td>${o.fabNote}</td></tr>
  </table>`;

  if(type==='carp') html=`
  <h3>برگه نجاری</h3>
  <table>
  <tr><th>مدل</th><td>${o.carpModel}</td></tr>
  <tr><th>توضیحات</th><td>${o.carpNote}</td></tr>
  </table>`;

  if(type==='up') html=`
  <h3>برگه روی‌کوبی</h3>
  <table>
  <tr><th>توضیحات</th><td>${o.upNote}</td></tr>
  </table>`;

  if(type==='del') html=`
  <h3>برگه تحویل</h3>
  <table>
  <tr><th>مشتری</th><td>${o.customer}</td></tr>
  <tr><th>مدل</th><td>${o.model}</td></tr>
  <tr><th>تاریخ تحویل</th><td>${o.delDate}</td></tr>
  <tr><th>آدرس/توضیحات</th><td>${o.delNote}</td></tr>
  </table>`;

  const out=document.getElementById('output');
  out.innerHTML=`
  <h2>${o.customer} | مدل ${o.model}</h2>${html}
  <div style="text-align:center;margin-top:8px;">
    <button class='btn' onclick='window.print()'>🖨 چاپ</button>
    <button class='btn' onclick='sendWhatsApp(${i},"${type}")'>📤 ارسال واتساپ</button>
  </div>`;
  out.style.display='block';
  window.scrollTo(0,document.body.scrollHeight);
}

function sendWhatsApp(i,type){
  const o=orders[i];
  const msg=encodeURIComponent(`برگه ${type} | مشتری: ${o.customer} | مدل: ${o.model}`);
  window.open(`https://wa.me/?text=${msg}`,'_blank');
}
</script>
</body>
</html>
